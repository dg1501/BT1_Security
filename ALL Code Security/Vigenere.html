<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Mã hóa Vigenère</title>
    <style>
      body {
        font-family: Arial;
        margin: 30px;
      }
      input,
      button {
        margin: 5px;
        padding: 5px;
      }
      #result {
        margin-top: 10px;
        font-weight: bold;
        color: green;
      }
    </style>
  </head>
  <body>
    <h2>Mã hóa Vigenère</h2>
    <label>Văn bản:</label><br />
    <input type="text" id="text" size="40" /><br />
    <label>Khóa:</label><br />
    <input type="text" id="key" /><br />
    <button onclick="encrypt()">Mã hóa</button>
    <button onclick="decrypt()">Giải mã</button>

    <div id="result"></div>

    <script>
      function encrypt() {
        let text = document.getElementById("text").value;
        let key = document.getElementById("key").value.toLowerCase();
        let result = "";
        let m = key.length;

        for (let i = 0, j = 0; i < text.length; i++) {
          let c = text[i];
          if (/[a-zA-Z]/.test(c)) {
            let base = c === c.toUpperCase() ? 65 : 97;
            let k = key[j % m].charCodeAt(0) - 97;
            result += String.fromCharCode(
              ((c.charCodeAt(0) - base + k) % 26) + base
            );
            j++;
          } else {
            result += c;
          }
        }

        document.getElementById("result").innerText = "Bản mã: " + result;
      }

      function decrypt() {
        let text = document.getElementById("text").value;
        let key = document.getElementById("key").value.toLowerCase();
        let result = "";
        let m = key.length;

        for (let i = 0, j = 0; i < text.length; i++) {
          let c = text[i];
          if (/[a-zA-Z]/.test(c)) {
            let base = c === c.toUpperCase() ? 65 : 97;
            let k = key[j % m].charCodeAt(0) - 97;
            result += String.fromCharCode(
              ((c.charCodeAt(0) - base - k + 26) % 26) + base
            );
            j++;
          } else {
            result += c;
          }
        }

        document.getElementById("result").innerText = "Bản rõ: " + result;
      }
    </script>
  </body>
</html>
